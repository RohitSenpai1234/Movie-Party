{"ast":null,"code":"import { io } from \"socket.io-client\";\n\n// Use environment-based backend URL with fallback options\nconst BACKEND_URL = process.env.NODE_ENV === 'production' ? process.env.REACT_APP_BACKEND_URL || \"https://movie-watch-party-production.up.railway.app\" : \"http://localhost:5000\";\n\n// Log the backend URL being used for debugging\nconsole.log('Using backend URL:', BACKEND_URL);\nconst socket = io(BACKEND_URL, {\n  // Configure transports for Railway compatibility\n  transports: [\"polling\", \"websocket\"],\n  // Try polling first as fallback\n  upgrade: true,\n  // Allow transport upgrades\n  rememberUpgrade: false,\n  // Don't remember failed upgrades\n\n  // Connection settings for production stability\n  reconnection: true,\n  reconnectionDelay: 2000,\n  reconnectionDelayMax: 10000,\n  reconnectionAttempts: 10,\n  // Timeout and performance settings\n  timeout: 15000,\n  autoConnect: true,\n  // Security and proxy settings for Railway\n  withCredentials: false,\n  rejectUnauthorized: false,\n  // Allow self-signed certificates if needed\n\n  // Additional options for Railway's proxy infrastructure\n  forceNew: true,\n  // Create a new connection instance\n  path: '/socket.io/',\n  // Match backend path configuration\n  closeOnBeforeunload: false // Prevent closure on page unload\n});\n\n// Add comprehensive error handling for debugging\nsocket.on('connect_error', error => {\n  console.error('Socket connection error:', error);\n  console.error('Connection attempt to:', BACKEND_URL);\n  console.error('Error type:', error.type);\n  console.error('Error message:', error.message);\n});\nsocket.on('connect_timeout', timeout => {\n  console.error('Socket connection timeout:', timeout);\n});\nsocket.on('reconnect_failed', () => {\n  console.error('Socket reconnection failed - giving up');\n  // Show user-friendly error message\n  alert('Unable to connect to server. Please check your internet connection and try refreshing the page.');\n});\nsocket.on('reconnecting', attemptNumber => {\n  console.log(`Socket reconnecting... Attempt: ${attemptNumber}`);\n});\nsocket.on('disconnect', reason => {\n  console.log('Socket disconnected:', reason);\n  if (reason === 'io server disconnect') {\n    // Server forcibly closed the connection\n    socket.connect();\n  }\n});\n\n// Add connection success handler\nsocket.on('connect', () => {\n  console.log('Socket connected successfully to:', BACKEND_URL);\n});\nexport default socket;","map":{"version":3,"names":["io","BACKEND_URL","process","env","NODE_ENV","REACT_APP_BACKEND_URL","console","log","socket","transports","upgrade","rememberUpgrade","reconnection","reconnectionDelay","reconnectionDelayMax","reconnectionAttempts","timeout","autoConnect","withCredentials","rejectUnauthorized","forceNew","path","closeOnBeforeunload","on","error","type","message","alert","attemptNumber","reason","connect"],"sources":["C:/Users/rohit/OneDrive/Desktop/SrtreamMovie/Movie-Party/frontend/src/socket.js"],"sourcesContent":["import { io } from \"socket.io-client\";\r\n\r\n// Use environment-based backend URL with fallback options\r\nconst BACKEND_URL = process.env.NODE_ENV === 'production' \r\n  ? process.env.REACT_APP_BACKEND_URL || \"https://movie-watch-party-production.up.railway.app\"\r\n  : \"http://localhost:5000\";\r\n\r\n// Log the backend URL being used for debugging\r\nconsole.log('Using backend URL:', BACKEND_URL);\r\n\r\nconst socket = io(BACKEND_URL, {\r\n  // Configure transports for Railway compatibility\r\n  transports: [\"polling\", \"websocket\"],  // Try polling first as fallback\r\n  upgrade: true,                        // Allow transport upgrades\r\n  rememberUpgrade: false,               // Don't remember failed upgrades\r\n  \r\n  // Connection settings for production stability\r\n  reconnection: true,\r\n  reconnectionDelay: 2000,\r\n  reconnectionDelayMax: 10000,\r\n  reconnectionAttempts: 10,\r\n  \r\n  // Timeout and performance settings\r\n  timeout: 15000,\r\n  autoConnect: true,\r\n  \r\n  // Security and proxy settings for Railway\r\n  withCredentials: false,\r\n  rejectUnauthorized: false,  // Allow self-signed certificates if needed\r\n  \r\n  // Additional options for Railway's proxy infrastructure\r\n  forceNew: true,             // Create a new connection instance\r\n  path: '/socket.io/',        // Match backend path configuration\r\n  closeOnBeforeunload: false  // Prevent closure on page unload\r\n});\r\n\r\n// Add comprehensive error handling for debugging\r\nsocket.on('connect_error', (error) => {\r\n  console.error('Socket connection error:', error);\r\n  console.error('Connection attempt to:', BACKEND_URL);\r\n  console.error('Error type:', error.type);\r\n  console.error('Error message:', error.message);\r\n});\r\n\r\nsocket.on('connect_timeout', (timeout) => {\r\n  console.error('Socket connection timeout:', timeout);\r\n});\r\n\r\nsocket.on('reconnect_failed', () => {\r\n  console.error('Socket reconnection failed - giving up');\r\n  // Show user-friendly error message\r\n  alert('Unable to connect to server. Please check your internet connection and try refreshing the page.');\r\n});\r\n\r\nsocket.on('reconnecting', (attemptNumber) => {\r\n  console.log(`Socket reconnecting... Attempt: ${attemptNumber}`);\r\n});\r\n\r\nsocket.on('disconnect', (reason) => {\r\n  console.log('Socket disconnected:', reason);\r\n  if (reason === 'io server disconnect') {\r\n    // Server forcibly closed the connection\r\n    socket.connect();\r\n  }\r\n});\r\n\r\n// Add connection success handler\r\nsocket.on('connect', () => {\r\n  console.log('Socket connected successfully to:', BACKEND_URL);\r\n});\r\n\r\nexport default socket;\r\n"],"mappings":"AAAA,SAASA,EAAE,QAAQ,kBAAkB;;AAErC;AACA,MAAMC,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,GACrDF,OAAO,CAACC,GAAG,CAACE,qBAAqB,IAAI,qDAAqD,GAC1F,uBAAuB;;AAE3B;AACAC,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEN,WAAW,CAAC;AAE9C,MAAMO,MAAM,GAAGR,EAAE,CAACC,WAAW,EAAE;EAC7B;EACAQ,UAAU,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC;EAAG;EACvCC,OAAO,EAAE,IAAI;EAAyB;EACtCC,eAAe,EAAE,KAAK;EAAgB;;EAEtC;EACAC,YAAY,EAAE,IAAI;EAClBC,iBAAiB,EAAE,IAAI;EACvBC,oBAAoB,EAAE,KAAK;EAC3BC,oBAAoB,EAAE,EAAE;EAExB;EACAC,OAAO,EAAE,KAAK;EACdC,WAAW,EAAE,IAAI;EAEjB;EACAC,eAAe,EAAE,KAAK;EACtBC,kBAAkB,EAAE,KAAK;EAAG;;EAE5B;EACAC,QAAQ,EAAE,IAAI;EAAc;EAC5BC,IAAI,EAAE,aAAa;EAAS;EAC5BC,mBAAmB,EAAE,KAAK,CAAE;AAC9B,CAAC,CAAC;;AAEF;AACAd,MAAM,CAACe,EAAE,CAAC,eAAe,EAAGC,KAAK,IAAK;EACpClB,OAAO,CAACkB,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;EAChDlB,OAAO,CAACkB,KAAK,CAAC,wBAAwB,EAAEvB,WAAW,CAAC;EACpDK,OAAO,CAACkB,KAAK,CAAC,aAAa,EAAEA,KAAK,CAACC,IAAI,CAAC;EACxCnB,OAAO,CAACkB,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAACE,OAAO,CAAC;AAChD,CAAC,CAAC;AAEFlB,MAAM,CAACe,EAAE,CAAC,iBAAiB,EAAGP,OAAO,IAAK;EACxCV,OAAO,CAACkB,KAAK,CAAC,4BAA4B,EAAER,OAAO,CAAC;AACtD,CAAC,CAAC;AAEFR,MAAM,CAACe,EAAE,CAAC,kBAAkB,EAAE,MAAM;EAClCjB,OAAO,CAACkB,KAAK,CAAC,wCAAwC,CAAC;EACvD;EACAG,KAAK,CAAC,iGAAiG,CAAC;AAC1G,CAAC,CAAC;AAEFnB,MAAM,CAACe,EAAE,CAAC,cAAc,EAAGK,aAAa,IAAK;EAC3CtB,OAAO,CAACC,GAAG,CAAC,mCAAmCqB,aAAa,EAAE,CAAC;AACjE,CAAC,CAAC;AAEFpB,MAAM,CAACe,EAAE,CAAC,YAAY,EAAGM,MAAM,IAAK;EAClCvB,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEsB,MAAM,CAAC;EAC3C,IAAIA,MAAM,KAAK,sBAAsB,EAAE;IACrC;IACArB,MAAM,CAACsB,OAAO,CAAC,CAAC;EAClB;AACF,CAAC,CAAC;;AAEF;AACAtB,MAAM,CAACe,EAAE,CAAC,SAAS,EAAE,MAAM;EACzBjB,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEN,WAAW,CAAC;AAC/D,CAAC,CAAC;AAEF,eAAeO,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}